<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Bookshelf</title>
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div id="logo"><a href="/">Online Bookshelf</a></div>
        <div id="links"></div>
        <div id="auth">
            <a href="/login/">Login</a>
            <a href="/register/">Register</a>
        </div>
    </nav>
    <section id="welcome-banner"></section>
    
    <div id="search-bar">
        <input type="text" id="search-input" placeholder="Search...">
        <select id="search-type">
            <option value="title">Title</option>
            <option value="author">Author</option>
            <option value="subject">Subject</option>
        </select>
        <button onclick="search()">Search</button>
        <div id="search-results"></div>
    </div>

    <script>
        function search() {
            var searchTerm = document.getElementById('search-input').value;
            var searchType = document.getElementById('search-type').value;

            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var searchResults = JSON.parse(this.responseText);
                    displaySearchResults(searchResults, searchType);
                }
            };
            xhttp.open("POST", "search.php", true);
            xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhttp.send("searchTerm=" + searchTerm + "&searchType=" + searchType);
        }

        function displaySearchResults(results, searchType) {
            var resultContainer = document.getElementById('search-results');
            resultContainer.innerHTML = '';

            if (results.length === 0) {
                resultContainer.innerHTML = 'No results found.';
            } else {
                var resultList = document.createElement('ul');

                results.forEach(function(result) {
                    var listItem = document.createElement('li');
                    if (searchType === 'title') {
                        // Make book titles clickable links
                        var link = document.createElement('a');
                        link.href = 'book_details.php?id=' + result.id; // Assuming 'id' is the primary key of your books table
                        link.textContent = result.title;
                        listItem.appendChild(link);
                    } else if (searchType === 'author') {
                       
			 listItem.textContent = "Title: " + result.title;
                    } else if (searchType === 'subject' && result.subject_facet) {
                        listItem.textContent = "Title: " + result.title; // Display the book title when searching by subject facet
                    }
                    resultList.appendChild(listItem);
                });

                resultContainer.appendChild(resultList);
            }
        }
    </script>

    <script src="main.js"></script>
</body>
</html>
